<script>
    document.getElementById("form").addEventListener("submit", function(event) {
        event.preventDefault();

        // Récupération des données du formulaire
        const formData = {
            nom: document.getElementById("nom").value,
            email: document.getElementById("email").value,
            telephone: document.getElementById("telephone").value,
            prestation: document.getElementById("prestation").value,
            date: document.getElementById("date").value,
            heure: document.getElementById("heure").value,
            message: document.getElementById("message").value
        };

        // Envoi des données au script Google Apps
        fetch("https://script.google.com/macros/s/AKfycbwQeiLqRt9VDtSaF4pjLbMbdw815a852WqbrHHC4fDInO1JHNdEw-3dhDVYRuih8OfC/exec", {
            method: "POST",
            headers: { 
                "Content-Type": "application/json"
            },
            body: JSON.stringify(formData),
            mode: "cors" // ⚠️ Ajout du mode CORS pour éviter les erreurs de préflight
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === "success") {
                alert("Données envoyées avec succès !");
            } else {
                alert("Erreur : " + data.message);
            }
        })
        .catch(error => console.error("Erreur :", error));
    });
</script>
